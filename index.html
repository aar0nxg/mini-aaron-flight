<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"/>
<title>Mini Flight: Aaron‚Äôs Journey</title>
<style>
:root{ --bg-1:#0b0820; --bg-2:#160f32; --bg-3:#201443; --accent:#ff5a7a; --accent-2:#b084ff; }
html,body{height:100%;margin:0;background:
  radial-gradient(1600px 100% at 50% 0%,rgba(255,255,255,.05),transparent),
  linear-gradient(180deg,var(--bg-1),var(--bg-2) 60%,var(--bg-3));
  color:#fff;font-family:system-ui,Segoe UI,Roboto,Helvetica,Arial;}
#gameRoot{position:relative;max-width:960px;margin:0 auto;height:100vh;overflow:hidden;
  box-shadow:0 8px 40px rgba(0,0,0,.35);border:1px solid rgba(255,255,255,.07);border-radius:16px}
canvas{display:block;width:100%;height:100%;outline:none}

.hud{position:absolute;top:12px;left:12px;display:flex;gap:10px;z-index:5}
.pill{background:rgba(0,0,0,.35);backdrop-filter:blur(6px);border:1px solid rgba(255,255,255,.15);padding:8px 12px;border-radius:999px}
.hud-right{position:absolute;top:12px;right:12px;display:flex;gap:10px;z-index:6}
.btn{cursor:pointer;user-select:none}
.bar{--p:0;position:relative;height:10px;width:240px;border-radius:999px;background:rgba(255,255,255,.15);overflow:hidden}
.bar::after{content:"";position:absolute;inset:0;width:calc(var(--p)*1%);background:linear-gradient(90deg,var(--accent),var(--accent-2))}
.rec{position:absolute;top:14px;right:14px;color:#ff4d4d;font-weight:800;text-shadow:0 0 10px #ff4d4d80}
.rec::before{content:"‚óè ";}

.overlay{position:absolute;inset:0;display:grid;place-items:center;background:rgba(10,0,20,.78);z-index:10;transition:opacity .25s}
.overlay.hidden{opacity:0;pointer-events:none}
.card{background:rgba(255,255,255,.07);padding:28px;border-radius:16px;text-align:center;border:1px solid rgba(255,255,255,.15);max-width:720px}
.action{border:none;padding:12px 18px;border-radius:12px;font-weight:800;cursor:pointer;background:linear-gradient(180deg,var(--accent),#ff87a0);color:#fff}

.holdZone{position:absolute;bottom:18px;left:50%;transform:translateX(-50%);z-index:7;background:rgba(255,255,255,.08);
          border:1px solid rgba(255,255,255,.2);backdrop-filter:blur(6px);padding:10px 16px;border-radius:999px;user-select:none}
.hint{opacity:.85;font-size:12px;margin-top:6px}

/* Mobile ‚Äúno highlight / no scroll‚Äù fix */
html, body, #gameRoot, canvas {
  touch-action: none; -ms-touch-action: none; overscroll-behavior: none;
  user-select: none; -webkit-user-select: none; -webkit-touch-callout: none;
}
* { -webkit-tap-highlight-color: transparent; }

/* Tiny sparkle hearts */
.heartBurst{position:absolute;left:50%;bottom:72px;pointer-events:none;z-index:8}
.heart{position:absolute;font-size:16px;opacity:0.9;text-shadow:0 0 8px rgba(255,90,122,.45), 0 0 14px rgba(176,132,255,.35);
  animation:riseHeart 1.1s ease-out forwards}
@keyframes riseHeart{
  0%{transform:translate(-50%,0) scale(.9); opacity:.0}
  10%{opacity:.95}
  70%{opacity:.85}
  100%{transform:translate(-50%,-110px) scale(1.05); opacity:0}
}
</style>
</head>
<body>
<div id="gameRoot">
  <canvas id="game" tabindex="0" aria-label="Mini Flight Game"></canvas>

  <div class="hud">
    <div class="pill" id="livesPill">‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</div>
    <div class="pill">‚úàÔ∏è Dist: <span id="km">10,000</span></div>
    <div class="pill bar" id="progress"></div>
  </div>
  <div class="hud-right">
    <div class="pill btn" id="pauseBtn" title="Pause/Resume">‚è∏Ô∏è</div>
    <div class="pill btn" id="muteBtn" title="Mute/Unmute">üîä</div>
  </div>
  <div class="rec">REC</div>

  <div class="holdZone" id="holdZone">Hold to fly ‚Üë ‚Ä¢ Space / ‚Üë / W also work</div>

  <!-- Start -->
  <div class="overlay" id="start">
    <div class="card">
      <h1 style="margin:0 0 8px">The Flight ‚úàÔ∏èüíú</h1>
      <p style="margin:0">Hold <b>Space / ‚Üë / W</b> or <b>hold screen/trackpad</b> to go up. Dodge meteors, birds, satellites, clouds, and gusts!</p>
      <p class="hint">3 lives. Hit = lose a heart. At 0 ‚Üí <b>Game Over</b>. Reach Zarifa ‚Üí <b>HUG WIN</b>.</p>
      <button class="action" id="playBtn">üé¨ Fly!</button>
    </div>
  </div>

  <!-- Game Over -->
  <div class="overlay hidden" id="gameover">
    <div class="card">
      <h2 style="margin:0 0 8px">Game Over üíî</h2>
      <p style="margin:0 0 12px">Press the button to try again.</p>
      <div style="display:flex;gap:8px;justify-content:center">
        <button class="action" id="retryBtn">‚Üª Restart</button>
      </div>
    </div>
  </div>

  <!-- Win -->
  <div class="overlay hidden" id="win">
    <div class="card">
      <h2 id="winTitle" style="margin:0 0 10px">Hug time! üíñ</h2>
      <img id="hugImg" src="" alt="Hug" style="image-rendering:pixelated;max-width:320px;width:100%;height:auto;border-radius:8px;border:1px solid rgba(255,255,255,.2);" />
      <button class="action" id="restartBtn">‚Üª Play Again</button>
    </div>
  </div>

  <div class="heartBurst" id="heartBurst"></div>
</div>

<script>
// ----------- Assets -----------
const assetPaths={
  pilot:"https://raw.githubusercontent.com/yourusername/yourrepo/main/aaron.png",
  hug:"https://raw.githubusercontent.com/yourusername/yourrepo/main/zarifa_hug.png",
  meteor:"https://raw.githubusercontent.com/yourusername/yourrepo/main/meteor.png",
  bird:"https://raw.githubusercontent.com/yourusername/yourrepo/main/bird.png",
  satellite:"https://raw.githubusercontent.com/yourusername/yourrepo/main/satellite.png",
  cloud:"https://raw.githubusercontent.com/yourusername/yourrepo/main/cloud.png"
};

let assets={};
let loadedCount=0;
const totalAssets=Object.keys(assetPaths).length;

function preloadAssets(callback){
  for(let key in assetPaths){
    let img=new Image();
    img.src=assetPaths[key];
    img.onload=()=>{loadedCount++; if(loadedCount===totalAssets) callback();}
    assets[key]=img;
  }
}

// ----------- Canvas & game state -----------
const canvas=document.getElementById('game');
const ctx=canvas.getContext('2d');
canvas.width=960; canvas.height=540;

let keys={};
let lives=3, dist=0, maxDist=10000;
let gameActive=false, paused=false, mute=false;
let obstacles=[];

// ----------- HUD -----------
const livesPill=document.getElementById("livesPill");
const km=document.getElementById("km");
const progress=document.getElementById("progress");

// ----------- Input -----------
document.addEventListener("keydown",e=>{keys[e.code]=true;if(e.code==="KeyM") mute=!mute;});
document.addEventListener("keyup",e=>keys[e.code]=false);

let holding=false;
const holdZone=document.getElementById("holdZone");
holdZone.addEventListener("pointerdown",()=>holding=true);
holdZone.addEventListener("pointerup",()=>holding=false);
holdZone.addEventListener("pointerleave",()=>holding=false);

// ----------- Buttons -----------
const startOverlay=document.getElementById("start");
const playBtn=document.getElementById("playBtn");
const gameoverOverlay=document.getElementById("gameover");
const retryBtn=document.getElementById("retryBtn");
const winOverlay=document.getElementById("win");
const restartBtn=document.getElementById("restartBtn");
const pauseBtn=document.getElementById("pauseBtn");
const muteBtn=document.getElementById("muteBtn");
const hugImg=document.getElementById("hugImg");

playBtn.onclick=startGame;
retryBtn.onclick=startGame;
restartBtn.onclick=startGame;
pauseBtn.onclick=()=>paused=!paused;
muteBtn.onclick=()=>mute=!mute;

// ----------- Hearts ----------
const heartBurst=document.getElementById("heartBurst");
function spawnHeart(){const heart=document.createElement("div");heart.className="heart";heart.innerText="üíñ";heartBurst.appendChild(heart);setTimeout(()=>heart.remove(),1200)}

// ----------- Game logic -----------
function startGame(){
  gameActive=true; paused=false;
  lives=3; dist=0; obstacles=[];
  livesPill.innerText="‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è"; km.innerText=maxDist; progress.style.setProperty("--p",0);
  hugImg.src=assets.hug.src;
  startOverlay.classList.add("hidden");
  gameoverOverlay.classList.add("hidden");
  winOverlay.classList.add("hidden");
  loop();
}

// ----------- Obstacle with patterns -----------
function spawnObstacle(){
  const types=["meteor","bird","satellite","cloud"];
  const type=types[Math.floor(Math.random()*types.length)];
  const speed=2+Math.random()*3;
  let pattern="straight";
  if(type==="bird") pattern="sine";
  if(type==="satellite") pattern="zigzag";
  obstacles.push({
    x:canvas.width,
    y:Math.random()*canvas.height*0.8+20,
    type:assets[type],
    speed: speed,
    pattern: pattern,
    offset: Math.random()*Math.PI*2
  });
}

// ----------- Update & render -----------
function updateObstacles(){
  for(let i=obstacles.length-1;i>=0;i--){
    const o=obstacles[i];
    switch(o.pattern){
      case "sine": o.y += Math.sin((Date.now()/200)+o.offset)*1.5; break;
      case "zigzag": o.y += (Math.sin((Date.now()/150)+o.offset)*2); break;
    }
    o.x -= o.speed;
    if(o.x<-60) obstacles.splice(i,1);
  }
}

function drawObstacles(){
  obstacles.forEach(o=>{
    ctx.drawImage(o.type,o.x,o.y,48,48);
  });
}

// ----------- Main loop -----------
function loop(){
  if(!gameActive) return;
  if(!paused){
    ctx.clearRect(0,0,canvas.width,canvas.height);

    // background
    ctx.fillStyle="#0b0820"; ctx.fillRect(0,0,canvas.width,canvas.height);

    // pilot
    let pilotY=canvas.height/2-32; if(keys["ArrowUp"]||keys["KeyW"]||keys["Space"]||holding) pilotY-=2;
    ctx.drawImage(assets.pilot,100,pilotY,64,64);

    // obstacles
    if(Math.random()<0.03) spawnObstacle();
    updateObstacles();
    drawObstacles();

    // distance
    dist+=3; if(dist>maxDist) dist=maxDist;
    km.innerText=maxDist-dist; progress.style.setProperty("--p",dist/maxDist*100);

    // collision (dummy for now)
    if(Math.random()<0.001){lives--; livesPill.innerText="‚ù§Ô∏è".repeat(lives); if(lives<=0){gameActive=false;gameoverOverlay.classList.remove("hidden"); return;}}
    // win
    if(dist>=maxDist){gameActive=false;winOverlay.classList.remove("hidden");spawnHeart(); return;}
  }
  requestAnimationFrame(loop);
}

// ----------- Preload all assets then enable start ---------
preloadAssets(()=>{console.log("All assets loaded!")});
</script>
</body>
</html>
