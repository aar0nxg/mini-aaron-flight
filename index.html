<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Doggo & Otter Space Game ðŸš€ðŸ’œ</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      background: black;
      height: 100%;
      width: 100%;
      user-select: none;           /* stop text/image selection */
      -webkit-user-select: none;
      -webkit-touch-callout: none; /* stop iOS tap-hold popup */
      touch-action: none;          /* disable browser gestures */
    }
    #root {
      position: relative;
      width: 100%;
      height: 100%;
      overflow: hidden;
      background: linear-gradient(to bottom, #0a001a, #1a0033);
    }
    canvas {
      width: 100%;
      height: 100%;
      display: block;
    }
    #start, #gameover, #win {
      position: absolute;
      top: 0; left: 0; right: 0; bottom: 0;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      background: rgba(0,0,0,0.7);
      color: white;
      font-family: monospace;
      font-size: 24px;
      text-align: center;
    }
    .hidden { display: none; }
    .btn {
      background: #6600cc;
      color: white;
      border: none;
      padding: 10px 20px;
      margin-top: 20px;
      font-size: 18px;
      cursor: pointer;
    }
    #hud {
      position: absolute;
      top: 10px; left: 10px;
      color: white;
      font-family: monospace;
      font-size: 18px;
      display: flex;
      gap: 10px;
    }
    #hud button {
      background: #222;
      color: white;
      border: 1px solid #555;
      padding: 5px 10px;
      cursor: pointer;
    }
    img.sprite {
      display: none;
    }
  </style>
</head>
<body>
  <div id="root">
    <canvas id="game"></canvas>

    <div id="start">
      <h1>ðŸš€ Doggo & Otter in Space ðŸ’œ</h1>
      <button class="btn" onclick="startGame()">Play</button>
    </div>

    <div id="gameover" class="hidden">
      <h1>ðŸ’” Game Over</h1>
      <button class="btn" onclick="startGame()">Retry</button>
    </div>

    <div id="win" class="hidden">
      <h1>ðŸ’– You Found Each Other!</h1>
      <img src="A_pixel_art_illustration_serves_as_the_winning_scr.png" alt="Win Screen">
      <button class="btn" onclick="startGame()">Play Again</button>
    </div>

    <div id="hud" class="hidden">
      <span id="score">Score: 0</span>
      <button onclick="togglePause()">Pause</button>
      <button onclick="toggleMute()">Mute</button>
    </div>
  </div>

  <!-- Sprites -->
  <img id="doggo" class="sprite" src="A_pixel_art_digital_illustration_depicts_a_charact.png">
  <img id="zarifa" class="sprite" src="A_pixel_art_digital_illustration_depicts_a_chibi-s.png">

  <script>
    const root = document.getElementById("root");
    const canvas = document.getElementById("game");
    const ctx = canvas.getContext("2d");

    const doggoImg = document.getElementById("doggo");
    const zarifaImg = document.getElementById("zarifa");

    let state = { mode: "start" }; // start | playing | gameover | win
    let ship, obstacles, score, pressing, paused, muted;

    function resize() {
      canvas.width = root.clientWidth;
      canvas.height = root.clientHeight;
    }
    window.addEventListener("resize", resize);
    resize();

    function startGame() {
      state.mode = "playing";
      document.getElementById("start").classList.add("hidden");
      document.getElementById("gameover").classList.add("hidden");
      document.getElementById("win").classList.add("hidden");
      document.getElementById("hud").classList.remove("hidden");
      score = 0;
      ship = { x: canvas.width/5, y: canvas.height/2, vy: 0 };
      obstacles = [];
      paused = false;
    }

    function togglePause() { paused = !paused; }
    function toggleMute() { muted = !muted; }

    function gameOver() {
      state.mode = "gameover";
      document.getElementById("gameover").classList.remove("hidden");
      document.getElementById("hud").classList.add("hidden");
    }
    function winGame() {
      state.mode = "win";
      document.getElementById("win").classList.remove("hidden");
      document.getElementById("hud").classList.add("hidden");
    }

    function loop() {
      requestAnimationFrame(loop);
      if (state.mode !== "playing" || paused) return;

      ctx.clearRect(0,0,canvas.width,canvas.height);

      // physics
      ship.vy += 0.5;
      if (pressing) ship.vy -= 1;
      ship.y += ship.vy;

      // keep inside
      if (ship.y < 0) ship.y = 0;
      if (ship.y > canvas.height-32) ship.y = canvas.height-32;

      // obstacles
      if (Math.random()<0.02) {
        const gap = 150;
        const topH = 50 + Math.random()*(canvas.height-gap-100);
        obstacles.push({x: canvas.width, top: topH, gap: gap});
      }
      obstacles.forEach(o => o.x -= 3);
      obstacles = obstacles.filter(o => o.x > -50);

      // draw doggo spaceship
      ctx.drawImage(doggoImg, ship.x, ship.y, 48, 48);

      // draw obstacles
      ctx.fillStyle = "purple";
      for (const o of obstacles) {
        ctx.fillRect(o.x, 0, 50, o.top);
        ctx.fillRect(o.x, o.top+o.gap, 50, canvas.height);
        // collision
        if (ship.x+40>o.x && ship.x<o.x+50) {
          if (ship.y<o.top || ship.y+40>o.top+o.gap) gameOver();
        }
        if (o.x+50===Math.floor(ship.x)) score++;
      }

      // score
      ctx.fillStyle = "white";
      ctx.font = "20px monospace";
      ctx.fillText("Score: "+score, 10, 30);
      document.getElementById("score").textContent = "Score: "+score;

      // win condition
      if (score>20) winGame();
    }
    requestAnimationFrame(loop);

    // ====== Input ======
    document.addEventListener("keydown", e=>{
      if (e.code==="Space") pressing=true;
    });
    document.addEventListener("keyup", e=>{
      if (e.code==="Space") pressing=false;
    });

    // ===== Mobile touch: prevent highlight/scroll, but allow UI taps =====
    ['touchstart','touchmove','touchend','touchcancel'].forEach(type => {
      root.addEventListener(type, (e) => {
        const target = e.target;

        // allow UI buttons/overlays to work
        if (target.closest('.btn, button, .action, #start, #gameover, #win')) {
          if ((type === 'touchstart') && state.mode !== 'playing') {
            // let the button handle it
          }
          return;
        }

        // block page scroll/selection
        e.preventDefault();

        // Game input
        if (state.mode === 'playing') {
          if (type === 'touchstart') pressing = true;
          if (type === 'touchend' || type === 'touchcancel') pressing = false;
        } else {
          if (type === 'touchstart') startGame();
        }
      }, { passive: false });
    });

    root.addEventListener('wheel', (e)=>{ e.preventDefault(); }, { passive:false });
  </script>
</body>
</html>
